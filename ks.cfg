cat /var/www/html/ks.cfg 
#Generated by Kickstart Configurator
#platform=x86

#System language
lang en_US
#Language modules to install
langsupport zh_CN --default=en_US
#System keyboard
keyboard us
#System mouse
mouse
#System timezone
timezone Asia/Shanghai
#Root password
rootpw --iscrypted $1$a000N4a/NXo$B0qEaige9zEHuDWc9bXc4tU.
#Initial user
user lavender --fullname "lavender geng" --iscrypted --password $1$CB.IM0I4bX$uz9Jp9UBAUqKJnJqqxZ5zX1
#Reboot after installation
reboot
#Use text mode install
text
#Install OS instead of upgrade
install
#Use Web installation
url --url http://192.168.0.105/ubuntu
#System bootloader configuration
bootloader --location=mbr 
#Clear the Master Boot Record
zerombr yes
#Partition clearing information
clearpart --all --initlabel 
#Disk partitioning information
part /boot --fstype ext4 --size 256 --asprimary 
part /home --fstype ext4 --size 10240 --asprimary 
part swap --size 2048 --asprimary 
part / --fstype ext4 --size 1 --grow --asprimary 
#System authorization infomation
auth  --useshadow  --enablemd5 
#Network information
network --bootproto=dhcp --device=ens33
#Firewall configuration
firewall --disabled --trust=eth0 --http --ssh 
#Do not configure the X Window System
skipx
#Package install information
%packages
@ kubuntu-desktop
openssh-server
%post

# setting hostname
hostname -I > /etc/hostname && sed -i 's/\./_/g' /etc/hostname
hostname -F /etc/hostname

# setting apt sources
cat <<EOF> /etc/apt/sources.list
# deb cdrom:[Ubuntu 16.04 LTS _Xenial Xerus_ - Release amd64 (20160420.1)]/ xenial main restricted
deb-src http://archive.ubuntu.com/ubuntu xenial main restricted #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted
deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted multiverse universe #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted
deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted multiverse universe #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial universe
deb http://mirrors.aliyun.com/ubuntu/ xenial-updates universe
deb http://mirrors.aliyun.com/ubuntu/ xenial multiverse
deb http://mirrors.aliyun.com/ubuntu/ xenial-updates multiverse
deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse #Added by software-properties
deb http://archive.canonical.com/ubuntu xenial partner
deb-src http://archive.canonical.com/ubuntu xenial partner
deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted
deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted multiverse universe #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial-security universe
deb http://mirrors.aliyun.com/ubuntu/ xenial-security multiverse
EOF

# add docker apt source and install docker
sudo apt-get update
sudo apt-get install apt-transport-https ca-certificates curl software-properties-common -y
curl -fsSL http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add -
sudo add-apt-repository "deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable"
sudo apt-get update
sudo apt-get install docker-ce=17.06.2~ce-0~ubuntu -y

# Change ip from dhcp to static
cat <<EOF> /tmp/interfaces
# This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

source /etc/network/interfaces.d/*

# The loopback network interface
auto lo
iface lo inet loopback

# The primary network interface
auto ens33
iface ens33 inet static
address IPADDR
netmask NETMASK
gateway GATEWAY
dns-nameservers DNSNAME01 DNSNAME02
EOF

IPADDR=`hostname -I|awk '{print $1}'`
NETMASK="255.255.255.0"
GATEWAY='192.168.0.1'
DNSNAME01='202.96.209.5'
DNSNAME02='8.8.8.8'
echo $NETMASK
sed -i "s/IPADDR/$IPADDR/g" /tmp/interfaces
sed -i "s/NETMASK/$NETMASK/g" /tmp/interfaces
sed -i "s/GATEWAY/$GATEWAY/g" /tmp/interfaces
sed -i "s/DNSNAME01/$DNSNAME01/g" /tmp/interfaces
sed -i "s/DNSNAME02/$DNSNAME02/g" /tmp/interfaces
mv /etc/network/interfaces /etc/network/interfaces.bak
cp /tmp/interfaces /etc/network/

sudo systemctl restart networking
